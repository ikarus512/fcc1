//-
  /* file: app2_nightlife.pug */
  /*!
   * Copyright 2017 ikarus512
   * https://github.com/ikarus512/fcc1.git
   *
   * DESCRIPTION: App2 Nightlife View
   * AUTHOR: ikarus512
   * CREATED: 2017/03/13
   *
   * MODIFICATION HISTORY
   *  2017/04/04, ikarus512. Added copyright header.
   *
   */

extend ./common/layout.pug

block vars
  - var title = 'Nightlife';
  - var background = 'background-color: #444; background-image: url(/img/pixabay_com_world.jpg);';

block scriptBeforeBody
  script(src='/lib/angular.min.js')
  script(src='/js/app2.js')
  script(src='/js/app2-controller-main.js')
  script(src='/js/app2-directive-map.js')
  script(src='/js/app2-factory-cafe-storage.js')

block scriptAfterBody
  script(src='https://maps.googleapis.com/maps/api/js?key='+process.env.APP_GOOGLE_MAPS_API_KEY+'&libraries=places,geometry')

block content
  .well
    h3 Nightlife Coordination App

  div(class="ng-app" ng-app="myApp2Cafes" ng-controller="myApp2ControllerMain" ng-init="init('"+app2session_lat+"','"+app2session_lng+"','"+app2session_zoom+"','"+app2session_radius+"')" ng-cloak)

    .row
      //- //////////////////////////////////////////////////////////
      //- //  map
      //- //////////////////////////////////////////////////////////
      .col-md-7
        .well
          my-google-map(map-cafes='cafes' map-center='center' map-zoom='zoom' style='width:100%;height:300px;' map-moved='mapMoved(newOpts)' cafe-selected='cafeSelected(cafeId)' cafe-unselected='cafeUnselected()')

      //- //////////////////////////////////////////////////////////
      //- //  cafesList
      //- //////////////////////////////////////////////////////////
      .col-md-5
        #noCafes.well(ng-show='!cafes.length' ng-cloak)
          label No restaurants/cafes/bars found.
        #cafesList.well(ng-show='cafes.length' ng-cloak)
          div(ng-repeat='cafe in cafes' ng-cloak)
            //- --------------------
            //- --  cafe
            //- --------------------
            .media(ng-show='cafe.show' style='border: 1px solid grey')
              .media-left
                a(href='#')
                  img.media-object(src='{{cafe.photo}}' alt='{{cafe.name}}')
              .media-body
                h4.media-heading {{cafe.name}}
                | {{cafe.text}}

                //- --------------------
                //- --  cafe visit plan
                //- --------------------
                p(ng-show='cafe.select')
                  b Visit Plan: &nbsp;
                  p
                    a.btn.btn-primary(href='/app2/cafes/{{cafe._id}}' title='Clear visit plans') clear
                    a.btn.btn-primary(href='/app2/cafes/{{cafe._id}}') attend today
                    a.btn.btn-primary(href='/app2/cafes/{{cafe._id}}') do not attend

    .row
      //- //////////////////////////////////////////////////////////
      //- //  Notes
      //- //////////////////////////////////////////////////////////
      .col-md-7
        .well
          - var SEARCH_LIMIT = 15;
          p
            b Note 1:
            |  There is internal restriction to show not more than
            |  #{SEARCH_LIMIT} cafes/bars/restaurant places simultaneously.
            |  So, some of them can be hidden, despite more ones available in database.
            |  To be sure to view all ones, please zoom up so that
            |  not more than #{SEARCH_LIMIT} ones are visible.
          p
            b Note 2:
            |  We use free account for Google search API. Hence it is
            |  a bit slow. Please be patient.
