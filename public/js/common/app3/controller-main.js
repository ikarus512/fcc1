/*! Copyright 2017 ikarus512 https://github.com/ikarus512/fcc1.git */!function(){"use strict";angular.module("myapp").controller("myApp3ControllerMain",["$scope","App3WebSocketService","MyConst","User","backendParams",function(a,t,e,n,o){a.ajaxLoadingSpinner=0,e.webApp?(a.logintype=o.logintype&&"undefined"!==o.logintype?o.logintype:"",a.username=o.username&&"undefined"!==o.username?o.username:""):n.check().then(function(){a.logintype=n.type,a.username=n.name});var s=20;a.chart1Data={title:"Title",note:"Description",data:function(){var a,t=new Date,e={},n=["initialZeroLine"];for(e.x=[],a=0;a<s;a++)e.x.push(new Date(t.getTime()-.5*(s-a)*1e3));return e.stocks={},n.forEach(function(t){for(e.stocks[t]={},e.stocks[t].id=t,e.stocks[t].values=[],a=0;a<s;a++)e.stocks[t].values.push({x:new Date(e.x[a]),y:0})}),e}()},a.$on("$destroy",function(){t.close()}),a.addStockName=function(a){t.addStockName(a)},a.removeStockName=function(a){t.removeStockName(a)},a.logintype&&(a.ajaxLoadingSpinner++,t.subscribe(function(t){function e(a){a.x=new Date(a.x)}function n(a){return a.x.getTime()>=c.data.x[0].getTime()}var o,c=a.chart1Data;t.data.x=t.data.x.map(function(a){return new Date(a)});for(o in t.data.stocks)t.data.stocks[o].values.forEach(e);c.data.x.length>=s&&c.data.x.splice(0,5);for(o in c.data.stocks)c.data.stocks[o].values=c.data.stocks[o].values.filter(n),c.data.stocks[o].values.length<2&&delete c.data.stocks[o];c.data.x=c.data.x.concat(t.data.x);for(o in t.data.stocks)c.data.stocks[o]||(c.data.stocks[o]={id:o,values:[]}),c.data.stocks[o].values=c.data.stocks[o].values.concat(t.data.stocks[o].values);a.chart1Data=c,a.$apply()}).finally(function(){a.ajaxLoadingSpinner--}))}])}();